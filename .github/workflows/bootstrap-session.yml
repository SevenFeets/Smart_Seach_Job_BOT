name: Bootstrap LinkedIn Session

on:
  workflow_dispatch:

jobs:
  upload-session:
    runs-on: ubuntu-latest
    steps:
      - name: Create session file from secret
        run: |
          mkdir -p browser_data
          echo '${{ secrets.LINKEDIN_SESSION_JSON }}' > browser_data/linkedin_session.json
      
      - name: Validate session file
        run: |
          if python3 -m json.tool browser_data/linkedin_session.json > /dev/null 2>&1; then
            echo "[OK] Session file is valid JSON"
          else
            echo "[ERROR] Invalid JSON"
            exit 1
          fi
      
      - name: Upload session artifact
        uses: actions/upload-artifact@v4
        with:
          name: linkedin-session
          path: browser_data/linkedin_session.json
          retention-days: 7
      
      - name: Success message
        run: |
          echo "[SUCCESS] Session uploaded successfully!"
          echo "You can now run the main job-bot workflow and it will use this session."
